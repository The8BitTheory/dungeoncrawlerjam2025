#RetroDevStudio.MetaData.BASIC:4097,BASIC V3.5,uppercase,10,10
1 DATA -8,8,1,-1,8,-8,-1,1

# 2D-3D TRANSFORMATION DATA
2 DATA -1,1,-9,-8,-7,-9,-7,-17,-17,-16,-15,-15,-17
3 DATA -15,-25,-25,-24,-23,-23,-8
4 DATA 8,-7,1,9,-7,9,-6,-6,2,10,10,-6,10,-5,-5,3
5 DATA 11,11,1,-1,9,8,7,9
6 DATA 7,17,17,16,15,15,17,15,25,25,24,23,23,8,-8,7,-1,-9,7
7 DATA -9,6,6,-2,-10
8 DATA-10,6,-10,5,5,-3,-11,-11

# MAP DATA
10 DATA 1,1,1,1,1,1,1,1, 1,0,0,0,0,0,0,1, 1,0,0,1,1,0,0,1, 1,0,0,0,0,0,0,1
11 DATA 1,0,1,0,1,1,0,1, 1,0,1,0,1,1,0,1, 1,0,0,0,0,1,0,1, 1,1,1,1,1,1,1,1

# SCREEN COORDINATES FOR DRAWING
20 DATA 0,0,0,1,1,1,7,0,8, 0,8,0,7,1,7,7,8,8, 1,0,1,1,1,1,7,0,7, 1,1,1,7,1,7,7,1,7
21 DATA 1,8,1,7,1,7,7,8,7, 0,1,1,2,2,2,6,1,7, 0,7,1,6,2,6,6,7,7, 0,0,2,1,2,1,6,0,6
22 DATA 0,1,2,2,2,2,6,1,6, 0,2,2,6,2,6,6,2,6, 0,7,2,6,2,6,6,7,6, 0,8,2,7,2,7,6,8,6
23 DATA 0,2,2,3,3,3,5,2,6, 0,6,2,5,3,5,5,6,6, 0,1,3,2,3,2,5,1,5, 0,2,3,3,3,3,5,2,5
24 DATA 0,3,3,5,3,5,5,3,5, 0,6,3,5,3,5,5,6,5, 0,7,3,6,3,6,5,7,5


30 P=26:DEFFNM(Z)=(PEEK(E+P+V(F,Z))-48)>0:GOSUB250
40 DIMV(3,19),D(19,8),M(63)


#  READ POSITION CHANGE DATA FOR MOVEMENT
42 FORX=0TO3:FORY=0TO1:READM:P(X,Y)=M:NEXT:NEXT

#  READ 2D-3D TRANSFORMATION DATA
44 FORY=0TO3:FORX=1TO19:READM:V(Y,X)=M:NEXT:NEXT

#  READ MAP DATA
46 FORX=0TO63:READM:M(X)=M:NEXT

#  READ SCREEN COORDINATES FOR DRAWING
48 FORX=1TO19:FORY=0TO8:READ M:D(X,Y)=M*16:NEXT:NEXT


60 DEFFNMO(Z)=INT(Z)-INT(INT(Z)/INT(4))*INT(4):GRAPHIC1:GOTO90

70 GETKEYI$:I=ASC(I$):F=FNMO(F+(I=81)+ABS(I=69)+4):IFI=65ORI=68THENMD=ABS(I=68):F=FNMO(F+3):GOSUB170:F=FNMO(F+5)

80 IFI=87ORI=83THENMD=ABS(I=83):GOSUB170:ELSEIFI=88THENGRAPHIC0:END
90 R=0:C$="ACH":GOSUB140:C$="BEL":GOSUB140:GOSUB100:C=0:GOSUB160:GOTO180
100 IFFNM(4)THENC=4:GOSUB160:RETURN
110 C$="FIO":GOSUB140:C$="GKS":GOSUB140:GOSUB120:RETURN
120 IFFNM(10)THENC=10:GOSUB160:RETURN
130 C$="MP":GOSUB140:C$="NR":GOSUB140:IFFNM(17)THENC=17:GOSUB160:RETURN:ELSERETURN
140 CX=1:DO:C=ASC(MID$(C$,CX,1))-64:S=FNM(C):IFSTHENGOSUB160
150 CX=CX+1:IFCX>LEN(C$)THENEXIT:ELSELOOPWHILES>=0:RETURN
160 R(R)=C:R=R+1:RETURN
170 T=P:P=P+P(F,MD):IFM(P)>0THENP=T:RETURN:ELSERETURN
180 R=0:SCNCLR:CHAR1,16,8,MID$("",F+1,1):DO
190 D=R(R)
200 DRAW 1,D(D,1),D(D,2) TO D(D,3),D(D,4)
210 DRAW 1,D(D,3),D(D,4) TO D(D,5),D(D,6)
220 DRAW 1,D(D,5),D(D,6) TO D(D,7),D(D,8)
230 DRAW 1,D(D,7),D(D,8) TO D(D,1),D(D,2)

240 R=R+1:LOOPWHILED>0:GOTO70:DATA-10,6,-10,5,5,-3,-11,-11
250 CHAR1,3,23," TO OVE,  TO XIT":RETURN